!function e(t,i,n){function o(s,a){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){var i=t[s][1][e];return o(i||e)},d,d.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){$.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null!=t?t[1]||0:null};var n=$.urlParam("chart");null!=n&&($(".chart").hide(),$("#"+n).show()),d3.json("./data/megaregions.json",function(e,t){d3.json("./shapefiles/megaregions.json",function(e,i){d3.json("./data/commuters.json",function(e,n){function o(e,t,i,n,o){d3.select(e).selectAll(".row").sort(function(e,t){if("name"==n){if("descend"==o)return d3.descending(e.regionName,t.regionName);if("ascend"==o)return d3.ascending(e.regionName,t.regionName)}if("city"==n){if("descend"==o)return d3.descending(e.primeCity,t.primeCity);if("ascend"==o)return d3.ascending(e.primeCity,t.primeCity)}if("area"==n){if("descend"==o)return d3.descending(e.plosName,t.plosName);if("ascend"==o)return d3.ascending(e.plosName,t.plosName)}if("metro"==n){if("descend"==o)return d3.descending(e.metro,t.metro);if("ascend"==o)return d3.ascending(e.metro,t.metro)}if("state"==n){if("descend"==o)return d3.descending(e.state,t.state);if("ascend"==o)return d3.ascending(e.state,t.state)}if("commuters"==n){if("descend"==o)return d3.descending(e.commuters,t.commuters);if("ascend"==o)return d3.ascending(e.commuters,t.commuters)}}).transition().duration(500)}var r=t.regions,s=n.commuters;d3.select("#listing").selectAll(".row").data(r.sort(function(e,t){return t.regionName-e.regionName})).enter().append("div").attr("class","row").attr("latitude",function(e){return e.latitude}).attr("longitude",function(e){return e.longitude}).html(function(e,t){return"<div class='col name'>"+e.regionName+"</div><div class='col city'>"+e.primeCity+"</div>"}),d3.select("#commuter_list").selectAll(".row").data(s.sort(function(e,t){return t.commuters-e.commuters})).enter().append("div").attr("class","row").attr("latitude",function(e){return e.latitude}).attr("longitude",function(e){return e.longitude}).html(function(e,t){return"<div class='col metro'>"+e.metro+"</div><div class='col state'>"+e.state+"</div><div class='col commuters'>"+d3.format(",")(e.commuters)+"</div>"}),$(document).ready(function(){$(".row").hide();var e=$("#filter_box").val();$(".row").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).show()}),$(".row").each(function(){-1==$(this).text().toUpperCase().indexOf("(MPLS)")&&-1==$(this).text().toUpperCase().indexOf("(STP)")||$(this).hide()}),$("#filter_box").on("keyup search",function(e){$("#listing .row").hide();var t=$("#filter_box").val();$("#listing .row").each(function(){-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).show()})}),$("#filter_box2").on("keyup search",function(e){$("#commuter_list .row").hide();var t=$("#filter_box2").val();$("#commuter_list .row").each(function(){-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).show()})}),$("#regions .th").click(function(){if($(".th").removeClass("selected3"),$(this).addClass("selected3"),$(this).hasClass("toggled")){$(this).removeClass("toggled");var e="ascend"}else if($(this).hasClass("selected3")){$(this).addClass("toggled");var e="descend"}o("#listing",null,r,$(this).attr("data"),e)}),$("#commutes .th").click(function(){if($(".th").removeClass("selected3"),$(this).addClass("selected3"),$(this).hasClass("toggled")){$(this).removeClass("toggled");var e="ascend"}else if($(this).hasClass("selected3")){$(this).addClass("toggled");var e="descend"}o("#commuter_list",null,s,$(this).attr("data"),e)}),$("#listing .row").click(function(){$("#listing .row").removeClass("selected"),$(this).addClass("selected"),$("#district").html($(this).find(".name").text());var e=Number($(this).attr("longitude")),t=Number($(this).attr("latitude"));d.flyTo({center:[e,t],zoom:5,pitch:0,bearing:0})}),$(".num").each(function(e,t){var i=$(this).text(),n=d3.format("+%")(i);$(this).html(n)})}),d3.helper={},d3.helper.tooltip=function(e){return function(t){var i,n=d3.select("body").node();t.on("mouseover",function(t,o){d3.select("body").selectAll("div.tooltip").remove(),i=d3.select("body").append("div").attr("class","tooltip");var r=d3.mouse(n);i.style("left",r[0]+10+"px").style("top",r[1]-15+"px").style("position","absolute").style("z-index",1001);e(t,o)}).on("mousemove",function(t,o){var r=d3.mouse(n);i.style("left",r[0]+10+"px").style("top",r[1]-15+"px");var s=e(t,o)||"";i.html(s)}).on("mouseout",function(e,t){i.remove()})}};var a=$("#map svg"),l=a.parent().width();a.attr("width",l),a.attr("height",l/1.625),mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var d=new mapboxgl.Map({container:"map",style:"mapbox://styles/shadowflare/cj0sgqols00br2smpojr2qgjs",center:[-98.5795,39.828175],zoom:2.5,minZoom:2});d.addControl(new mapboxgl.NavigationControl),d.scrollZoom.disable(),d.on("load",function(){d.addSource("regions",{type:"geojson",data:i}),d.addLayer({id:"regions-layer",interactive:!1,source:"regions",layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.2,"fill-color":"#888888","fill-outline-color":"rgba(255, 255, 255, 1)"}},"place-neighbourhood")})})})})},{}]},{},[1]);