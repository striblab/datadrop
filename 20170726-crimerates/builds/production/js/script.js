!function e(t,o,r){function a(i,l){if(!o[i]){if(!t[i]){var s="function"==typeof require&&require;if(!l&&s)return s(i,!0);if(n)return n(i,!0);throw new Error("Cannot find module '"+i+"'")}var d=o[i]={exports:{}};t[i][0].call(d.exports,function(e){var o=t[i][1][e];return a(o||e)},d,d.exports,e,t,o,r)}return o[i].exports}for(var n="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,o){$.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null!=t?t[1]||0:null};var r=$.urlParam("chart");null!=r&&($(".slide").hide(),$("#"+r).show()),d3.json("./shapefiles/minneapolis_nb.json",function(e,t){d3.json("./data/shootings.json",function(e,o){d3.json("./data/ranking.json",function(e,r){function a(e,t,o,r,a){d3.select(e).selectAll(".row").sort(function(e,t){if("neighborhood"==r){if("descend"==a)return d3.descending(e.neighborhood,t.neighborhood);if("ascend"==a)return d3.ascending(e.neighborhood,t.neighborhood)}if("rate"==r){if("descend"==a)return d3.descending(e.rate,t.rate);if("ascend"==a)return d3.ascending(e.rate,t.rate)}if("shooting"==r){if("descend"==a)return d3.descending(e.shooting,t.shooting);if("ascend"==a)return d3.ascending(e.shooting,t.shooting)}}).transition().duration(500)}var n=r.ranking;!function(){d3.select("#chart").selectAll(".row").data(n).enter().append("div").attr("class","row").style("background-color",function(e){return e.rate>=30?"#99000d":e.rate>=20?"#cb181d":e.rate>=10?"#ef3b2c":e.rate>=8?"#fb6a4a":e.rate>=6?"#fc9272":e.rate>=4?"#fcbba1":e.rate>=1?"#fee0d2":e.rate>=0?"#dddddd":void 0}).attr("latitude",function(e){return e.latitude}).attr("longitude",function(e){return e.longitude}).on("mousedown",function(e){$(".districtName").html(e.neighborhood),"Minneapolis"!=e.neighborhood?i.flyTo({center:[e.longitude,e.latitude],zoom:13}):i.flyTo({center:[-93.264313,44.973269],zoom:10})}).html(function(e,t){return"<div class='cell neighborhood'>"+e.neighborhood+"</div><div class='cell rate'>"+d3.format(".1f")(e.rate)+"</div><div class='cell shootings'>"+e.shooting+"</div>"})}(),$(document).ready(function(){$(".row").click(function(){$(".row").removeClass("rowSelect"),$(this).addClass("rowSelect")}),$(".hSort").click(function(){if($(".hSort").removeClass("selected"),$(this).addClass("selected"),$(this).hasClass("toggled")){$(this).removeClass("toggled");var e="ascend"}else if($(this).hasClass("selected")){$(this).addClass("toggled");var e="descend"}a("#chart",null,n,$(this).attr("data"),e)}),$("#filter_box").on("keyup search",function(e){$(".row").hide();var t=$("#filter_box").val();$(".row").each(function(){-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).show()})}),$("#filter_box").on("search",function(e){return $(".row").show(),$("#filter_box").val(""),i.flyTo({center:[-93.264313,44.973269],zoom:10}),$("#chart").animate({scrollTop:0},800),!1}),$(".scrollToTop").click(function(){return $(".row").show(),$("#filter_box").val(""),i.flyTo({center:[-93.264313,44.973269],zoom:10}),$("#chart").animate({scrollTop:0},800),!1})}),mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var i=new mapboxgl.Map({container:"map",style:"mapbox://styles/shadowflare/ciqzo0bu20004bknkbrhrm6wf",center:[-93.264313,44.973269],zoom:10,minZoom:10,hash:!1});i.addControl(new mapboxgl.NavigationControl),i.scrollZoom.disable(),i.doubleClickZoom.disable(),i.on("load",function(){i.addSource("nb",{type:"geojson",data:t}),i.addLayer({id:"nb-layer",interactive:!0,source:"nb",layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.7,"fill-color":{property:"maindata_rate",stops:[[0,"#dddddd"],[1,"#fee0d2"],[4,"#fcbba1"],[6,"#fc9272"],[8,"#fb6a4a"],[10,"#ef3b2c"],[20,"#cb181d"],[30,"#99000d"]]},"fill-outline-color":"rgba(255, 255, 255, 1)"}},"place-neighbourhood"),i.addSource("shootings",{type:"geojson",data:o}),i.addLayer({id:"shootings-layer",type:"circle",source:"shootings",paint:{"circle-radius":3,"circle-color":"rgba(150, 150, 150, 0.8)"},filter:["==","WeaponCategory","UNARMED"]}),i.addLayer({id:"shootings-layer2",type:"circle",source:"shootings",paint:{"circle-radius":3,"circle-color":"rgba(66, 134, 244, 0.8)"},filter:["!=","WeaponCategory","UNARMED"]});var e=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});i.on("mousemove",function(t){var o=i.queryRenderedFeatures(t.point,{layers:["shootings-layer","shootings-layer2"]});if(i.getCanvas().style.cursor=o.length?"pointer":"",!o.length)return void e.remove();var r=o[0];e.setLngLat(t.lngLat).setHTML("<div>"+r.properties.FirstName+" "+r.properties.LastName+"</div><div>died in "+r.properties.year+"</div><div>"+r.properties.WeaponCategory+"</div>").addTo(i)})}),function(){c3.generate({bindto:"#raceChart",padding:{top:20,right:60,bottom:20,left:80},data:{columns:[["Deaths",.172,.62,.068,.068,.068],["Minneapolis",.603,.186,.056,.02,.105]],type:"bar"},legend:{show:!1},color:{pattern:["#ef3b2c","#333333"]},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:5,format:d3.format("%.0f"),values:[0,.25,.5,.75,1]}},x:{type:"category",tick:{rotate:-60,multiline:!1},height:40,categories:["White","Black","Asian","Native","Hispanic"],padding:{left:.25,right:.25}}},regions:[{axis:"x",start:2007,end:2009,class:"hottest"}]})}(),d3.csv("./data/timeline.csv",function(e){return{filed:e.DeathDate,race:e.Race,status:e.armed,code:+e.Code,last:e.LastName,first:e.FirstName,year:e.year}},function(e,t){var o=t,r=[],a=[],n=[];r[0]="axis",a[0]="Armed",n[0]="Unarmed";for(var i=0;i<o.length;i++)r[i+1]=d3.time.format("%m-%d-%Y")(new Date(o[i].filed)),10==o[i].code&&(n[i+1]=o[i].code,a[i+1]=null),30==o[i].code&&(n[i+1]=null,a[i+1]=o[i].code);console.log(r),console.log(a);var l={top:20,right:80,bottom:20,left:80};c3.generate({bindto:"#timelineChart",padding:l,point:{r:4},data:{xs:{Armed:"axis",Unarmed:"axis"},columns:[r,a,n],type:"scatter"},color:{pattern:["#4286f4","#969696"]},legend:{show:!1},axis:{y:{min:0,padding:{bottom:0},tick:{format:function(e){switch(e){case 30:return"Armed";case 10:return"Unarmed"}},values:[10,30]}},x:{type:"categories",categories:["05-14-2000","07-22-2006","05-12-2012","07-15-2017"],tick:{count:4,multiline:!1}}},tooltip:{contents:function(e,t,r,a){var n,i,l,s,d,c=this,u=c.config,f=u.tooltip_format_title||t,h=u.tooltip_format_name||function(e){return e},g=u.tooltip_format_value||r;for(i=0;i<e.length;i++)if(e[i]&&(e[i].value||0===e[i].value)){n||(l=f?f(e[i].x):e[i].x,n="<table class='"+c.CLASS.tooltip+" fixtip'>"+(l||0===l?"<tr><th colspan='2'>"+l+"</th></tr>":""));var p="";h(e[i].name),s=g(e[i].value,e[i].ratio,e[i].id,e[i].index),d=c.levelColor?c.levelColor(e[i].value):a(e[i].id);for(var m=0;m<o.length;m++)if(d3.time.format("%m-%d-%Y")(new Date(o[m].filed))==l){p=o[m].first+" "+o[m].last;break}n+="<tr class='"+c.CLASS.tooltipName+"-"+e[i].id+"'>",n+="<td class='name'><span style='background-color:"+d+"'></span>Death</td>",n+="<td class='value'>"+s+"</td>",n+="</tr><tr>",n+="<tr class='value'><td style='width:100%' colspan='2'>"+p+"</td></tr>"}return n+"</table>"}}})})})})})},{}]},{},[1]);